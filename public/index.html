<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AgroDigital5.0™ – Global Token Panel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- PWA / APP SETTINGS -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" sizes="192x192" href="assets/icon-192.png">
  <link rel="apple-touch-icon" sizes="512x512" href="assets/icon-512.png">
  <meta name="theme-color" content="#002233">

  <!-- BOOTSTRAP & ICONS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/flag-icons/css/flag-icons.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- SEU CSS PRINCIPAL -->
  <link rel="stylesheet" href="styles.css">

  <!-- JS LIBS ESSENCIAIS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers/dist/ethers.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/i18next@21.6.3/i18next.min.js"></script>
  <meta name="description" content="AgroDigital 5.0™ – The global ESG-certified token panel for agricultural value.">
  <link rel="icon" type="image/png" href="assets/icon-192.png">
  <link rel="apple-touch-startup-image" href="assets/icon-512.png">
</head>
<body>
  <!-- NAVBAR EXECUTIVO -->
  <nav class="navbar navbar-dark bg-dark px-3 d-flex justify-content-between align-items-center">
    <span class="navbar-brand mb-0 h1">AgroDigital5.0™</span>
    <div>
      <button class="btn btn-link p-0 me-2" onclick="changeLang('en')" title="English">
        <span class="fi fi-us fis" style="font-size:1.6em;"></span>
      </button>
      <button class="btn btn-link p-0 me-2" onclick="changeLang('pt')" title="Português">
        <span class="fi fi-br fis" style="font-size:1.6em;"></span>
      </button>
      <button class="btn btn-link p-0 me-2" onclick="changeLang('es')" title="Español">
        <span class="fi fi-es fis" style="font-size:1.6em;"></span>
      </button>
      <span class="badge bg-primary" id="currentLang">EN</span>
    </div>
  </nav>

  <main class="container py-5">
    <!-- Título e descrição -->
    <section class="text-center mb-4">
      <h1 id="mainTitle">Welcome to AgroDigital5.0™</h1>
      <p id="mainDesc">Secure, Global & ESG Certified Token Sales</p>
    </section>
    <div class="row g-3">
      <div class="col-md-6">
        <div class="card p-3">
          <h5 id="tokenSaleTitle">Buy Tokens</h5>
          <button class="btn btn-success mb-2" onclick="connectWallet()" id="walletBtn">Connect Wallet</button>
          <button class="btn btn-primary mb-2" onclick="buyToken()" id="buyTokenBtn">Buy</button>
          <button class="btn btn-warning mb-2" onclick="donateAmazonNFT()" id="donateNFTBtn">Donate & Get NFT</button>
          <div id="walletAddress" class="small text-muted"></div>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card p-3">
          <h5 id="metricsTitle">Live Metrics</h5>
          <canvas id="cryptoChart" height="100"></canvas>
        </div>
      </div>
    </div>

    <!-- ESG, Governança, Parceiros -->
    <div class="row g-3 mt-3">
      <div class="col-md-4">
        <div class="card p-3">
          <h5 id="esgTitle">ESG Impact</h5>
          <p id="esgDesc">Automatic donation to green causes for every sale</p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card p-3">
          <h5 id="governanceTitle">Governance</h5>
          <p id="governanceDesc">On-chain DAO, voting and real-time auditing</p>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card p-3">
          <h5 id="partnersTitle">Partners & VIP</h5>
          <p id="partnersDesc">VIP area and exclusive perks for major investors</p>
        </div>
      </div>
    </div>

    <!-- VINCULAR CONTRATO DINAMICAMENTE -->
    <div class="row justify-content-center mt-4">
      <div class="col-auto">
        <input type="text" id="inputContract" class="form-control" style="width:300px" placeholder="Cole o endereço do contrato (0x...)">
      </div>
      <div class="col-auto">
        <button class="btn btn-info" onclick="setContractAddress()">Vincular Contrato</button>
      </div>
    </div>
    <!-- LINK BscScan -->
    <div class="mt-3 text-center">
      <a id="bscscanLink" href="https://bscscan.com/address/0x0000000000000000000000000000000000000000" class="btn btn-outline-info" target="_blank">
        <i class="bi bi-link-45deg"></i> <span id="bscscanBtn">Verify on BscScan</span>
      </a>
    </div>
  </main>

  <!-- IA ASSISTENTE -->
  <div class="cael-ai position-fixed bottom-0 end-0 p-3" style="z-index:999;">
    <button class="btn btn-dark" onclick="toggleIA()"><i class="bi bi-robot"></i> AI Support</button>
    <div id="iaBox" class="card p-2 mt-2" style="display:none; width:300px;">
      <input type="text" id="iaCommand" class="form-control mb-2" placeholder="Ask anything...">
      <button class="btn btn-success w-100" onclick="sendIACommand()"><i class="bi bi-send"></i> Send</button>
      <div id="iaResponse" class="mt-2 small text-muted"></div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="text-center mt-5 mb-2 small">
    <hr>
    <span>©️ 2025 AgroDigital5.0™ – All Rights Reserved.</span>
    <br>
    <span class="text-danger">Anti-plagiarism: All content digitally protected.</span>
  </footer>

  <!-- FUNÇÕES EXECUTIVAS DO PAINEL -->
  <script>
    // ========== Gráfico Minimalista ==========
    document.addEventListener('DOMContentLoaded', function () {
      const ctx = document.getElementById('cryptoChart').getContext('2d');
      new Chart(ctx, {
        type: 'line',
        data: {
          labels: ['CornToken', 'BNB', 'ETH', 'BTC'],
          datasets: [{
            label: 'Crypto Prices',
            data: [15.3, 5, 3, 9],
            borderColor: '#00a86b',
            borderWidth: 2,
            fill: true,
            backgroundColor: 'rgba(0,168,107,0.12)'
          }]
        },
        options: { responsive: true, plugins: { legend: { display: false } } }
      });
    });

    // ========== MetaMask e Wallet ==========
    function connectWallet() {
      if (window.ethereum) {
        window.ethereum.request({ method: 'eth_requestAccounts' })
          .then(accounts => {
            document.getElementById('walletAddress').innerText = accounts[0];
          });
      } else {
        alert("Please install MetaMask to continue!");
      }
    }
    function buyToken() {
      alert("Token purchased successfully! (Integre seu smart contract real aqui)");
    }
    function donateAmazonNFT() {
      alert("NFT ESG created/donated! (Integre seu smart contract real aqui)");
    }

    // ========== IA Minimalista (simulada) ==========
    function toggleIA() {
      const box = document.getElementById('iaBox');
      box.style.display = box.style.display === 'none' ? 'block' : 'none';
    }
    function sendIACommand() {
      const command = document.getElementById('iaCommand').value;
      document.getElementById('iaResponse').innerText = 'Aguardando resposta da IA (integre GPT ou Cael API aqui).';
      setTimeout(() => {
        document.getElementById('iaResponse').innerText = 'Comando "'+command+'" processado.';
      }, 1000);
      document.getElementById('iaCommand').value = "";
    }

    // ========== MULTI-IDIOMA (exemplo simples) ==========
    function changeLang(lang) {
      const texts = {
        en: {
          mainTitle: "Welcome to AgroDigital5.0™",
          mainDesc: "Secure, Global & ESG Certified Token Sales",
          tokenSaleTitle: "Buy Tokens",
          walletBtn: "Connect Wallet",
          buyTokenBtn: "Buy",
          donateNFTBtn: "Donate & Get NFT",
          metricsTitle: "Live Metrics",
          esgTitle: "ESG Impact",
          esgDesc: "Automatic donation to green causes for every sale",
          governanceTitle: "Governance",
          governanceDesc: "On-chain DAO, voting and real-time auditing",
          partnersTitle: "Partners & VIP",
          partnersDesc: "VIP area and exclusive perks for major investors",
          bscscanBtn: "Verify on BscScan"
        },
        pt: {
          mainTitle: "Bem-vindo à AgroDigital5.0™",
          mainDesc: "Venda de Tokens Segura, Global e Certificada ESG",
          tokenSaleTitle: "Comprar Tokens",
          walletBtn: "Conectar Carteira",
          buyTokenBtn: "Comprar",
          donateNFTBtn: "Doar & Receber NFT",
          metricsTitle: "Métricas em Tempo Real",
          esgTitle: "Impacto ESG",
          esgDesc: "Doação automática a causas verdes a cada venda",
          governanceTitle: "Governança",
          governanceDesc: "DAO on-chain, votação e auditoria em tempo real",
          partnersTitle: "Parceiros & VIP",
          partnersDesc: "Área VIP e benefícios exclusivos para grandes investidores",
          bscscanBtn: "Verificar no BscScan"
        },
        es: {
          mainTitle: "Bienvenido a AgroDigital5.0™",
          mainDesc: "Ventas de tokens seguras, globales y certificadas ESG",
          tokenSaleTitle: "Comprar Tokens",
          walletBtn: "Conectar Cartera",
          buyTokenBtn: "Comprar",
          donateNFTBtn: "Donar y Obtener NFT",
          metricsTitle: "Métricas en Vivo",
          esgTitle: "Impacto ESG",
          esgDesc: "Donación automática a causas verdes en cada venta",
          governanceTitle: "Gobernanza",
          governanceDesc: "DAO on-chain, votación y auditoría en tiempo real",
          partnersTitle: "Socios & VIP",
          partnersDesc: "Área VIP y beneficios exclusivos para grandes inversores",
          bscscanBtn: "Verificar en BscScan"
        }
      };
      let t = texts[lang];
      for (let k in t) {
        let el = document.getElementById(k);
        if (el) el.innerText = t[k];
      }
      document.getElementById('currentLang').innerText = lang.toUpperCase();
    }

    // ========== VINCULAR CONTRATO BscScan DINAMICAMENTE ==========
    let contractAddress = localStorage.getItem('bscContract') || '0x0000000000000000000000000000000000000000';
    function updateBscScanLink() {
      const bscscanLink = document.getElementById('bscscanLink');
      bscscanLink.href = `https://bscscan.com/address/${contractAddress}`;
    }
    function setContractAddress() {
      const input = document.getElementById('inputContract').value.trim();
      if (/^0x[a-fA-F0-9]{40}$/.test(input)) {
        contractAddress = input;
        localStorage.setItem('bscContract', contractAddress);
        updateBscScanLink();
        alert('Contrato vinculado com sucesso!');
      } else {
        alert('Endereço inválido. Certifique-se de que começa com 0x e tem 42 caracteres.');
      }
    }
    document.addEventListener('DOMContentLoaded', () => {
      updateBscScanLink();
      changeLang('en'); // idioma padrão ao abrir
    });

  </script>

  <!-- PWA Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('sw.js');
      });
    }
  </script>
</body>
</html>
